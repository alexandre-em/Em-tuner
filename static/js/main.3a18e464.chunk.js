(this.webpackJsonptuner=this.webpackJsonptuner||[]).push([[0],{67:function(e,t,n){},90:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),c=n(53),a=n.n(c),i=(n(67),n(112)),u=n(111),s=n(25),l=n(12),f=n(102),d=n(107),h=n(109);var b,j,p,x,y,v,O,g=n(31),q=n(21),w=n.n(q),m=n(56),S=window.AudioContext||window.webkitAudioContext||!1,M=function(){var e=Object(g.a)(w.a.mark((function e(t){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b=new S,e.next=3,navigator.mediaDevices.getUserMedia({audio:!0,video:!1});case 3:j=e.sent,E(b,j,t);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=function(){var e=Object(g.a)(w.a.mark((function e(){var t;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(t=j)||void 0===t?void 0:t.getTracks().forEach(function(){var e=Object(g.a)(w.a.mark((function e(t){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.stop();case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:if("running"!==b.state&&"suspended"!==b.state){e.next=5;break}return e.next=5,b.close();case 5:console.log(j,b);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),E=function(e,t,n){var r=function(){var t=Object(g.a)(w.a.mark((function t(o,a){return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("suspended"!==e.state){t.next=3;break}return t.next=3,e.resume();case 3:o?console.error(o):(a&&n(a),c.getPitch(r));case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),o=Object({NODE_ENV:"production",PUBLIC_URL:"/Em-tuner",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_ENDPOINT||"models/",c=Object(m.pitchDetection)(o,e,t,(function(){console.log("Model Loaded!"),c.getPitch(r)}))},k=n(16),T=n(18),_=T.a.div(p||(p=Object(k.a)(["\n  flex: 0.4;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n"]))),A=T.a.div(x||(x=Object(k.a)(["\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n\talign-items: center;\n  justify-content: space-around;\n"]))),B=T.a.div((function(e){return{backgroundColor:e.backgroundColor,position:"relative",width:"90%",height:80,borderRadius:100,display:"flex",justifyContent:"center",border:"2px solid white",color:"rgb(76, 150, 76)",boxShadow:"10px 10px 21px -7px rgba(0, 0, 0, 0.2)",WebkitBoxShadow:"10px 10px 21px -7px rgba(0, 0, 0, 0.2)",MozBoxShadow:"10px 10px 21px -7px rgba(0, 0, 0, 0.2)",margin:20}})),D=(T.a.div((function(e){var t=e.progress;return Object(s.a)(Object(s.a)({width:"".concat(Math.abs(t),"%"),height:"100%"},t>0&&{borderRight:".25vw solid red"}),t<0&&{borderLeft:".25vw solid red"})})),T.a.div(y||(y=Object(k.a)(["\n  position: absolute;\n  top: 25%;\n  color: white;\n"])))),P=n(3);function R(e){var t=e.show,n=void 0===t||t,o=e.onStart,c=e.onClose,a=function(){function e(e){this.val=e,this.left=this.right=null}var t=function t(n){if(1===n.length)return new e(n[0]);if(0===n.length)return null;var r=Math.floor(n.length/2),o=new e(n[r]),c=n.slice(0,r);o.left=t(c);var a=n.slice(r+1,n.length);return o.right=t(a),o},n=t([{frequency:28,note:"A0"},{frequency:31,note:"B0"},{frequency:33,note:"C1"},{frequency:37,note:"D1"},{frequency:41,note:"E1"},{frequency:44,note:"F1"},{frequency:49,note:"G1"},{frequency:55,note:"A1"},{frequency:62,note:"B1"},{frequency:65,note:"C2"},{frequency:73,note:"D2"},{frequency:82,note:"E2"},{frequency:87,note:"F2"},{frequency:98,note:"G2"},{frequency:110,note:"A2"},{frequency:123,note:"B2"},{frequency:131,note:"C3"},{frequency:147,note:"D3"},{frequency:165,note:"E3"},{frequency:175,note:"F3"},{frequency:196,note:"G3"},{frequency:220,note:"A3"},{frequency:247,note:"B3"},{frequency:262,note:"C4"},{frequency:294,note:"D4"},{frequency:330,note:"E4"},{frequency:349,note:"F4"},{frequency:392,note:"G4"},{frequency:440,note:"A4"},{frequency:494,note:"B4"}]);return{TreeNode:e,toBST:t,frequenciesBST:n,closestValue:function e(t,n){if(t.val.frequency===n)return t;if(n<t.val.frequency){if(!t.left)return t;var r=e(t.left,n);return Math.abs(r.val.frequency-n)>Math.abs(t.val.frequency-n)?t:r}if(!t.right)return t;var o=e(t.right,n);return Math.abs(o.val.frequency-n)>Math.abs(t.val.frequency-n)?t:o}}}(),i=a.frequenciesBST,u=a.closestValue,b=Object(r.useState)(),j=Object(l.a)(b,2),p=j[0],x=j[1],y=Object(r.useState)(""),v=Object(l.a)(y,2),O=v[0],g=v[1],q=Object(r.useState)(0),w=Object(l.a)(q,2),m=w[0],S=w[1],E=Object(r.useState)(),k=Object(l.a)(E,2),T=k[0],R=k[1],F=Object(r.useState)(!1),N=Object(l.a)(F,2),I=N[0],L=N[1],G=Object(r.useMemo)((function(){return I?"outlined":"contained"}),[I]),W=Object(r.useMemo)((function(){return I?"error":"primary"}),[I]),H=Object(r.useMemo)((function(){return I?Object(P.jsx)(d.a,{}):Object(P.jsx)(f.a,{})}),[I]),K=Object(r.useCallback)((function(){I||M(R).then((function(){L(!0),o&&o()})),I&&C().then((function(){L(!1),c&&c()}))}),[I,c,o]),U=Object(r.useMemo)((function(){return"hsl(".concat(Math.abs(120-m),"deg, 55%, 65%)")}),[m]);return Object(r.useEffect)((function(){if(T&&I)if(p){var e=Math.floor(5.9*(Math.abs(Math.floor(T))-p.val.frequency));(e<-105||e>105)&&x(u(i,Math.abs(Math.floor(T)))),S(e),g(p.val.note)}else x(u(i,Math.abs(Math.floor(T))))}),[T,I]),n?Object(P.jsx)(_,{"data-test":"tuner",children:Object(P.jsxs)(A,{children:[Object(P.jsxs)(B,{backgroundColor:U,children:[Object(P.jsx)("div",{className:"tuner__progress",style:Object(s.a)(Object(s.a)({width:"".concat(Math.abs(m),"%"),height:"100%"},m>0&&{borderRight:".25vw solid red"}),m<0&&{borderLeft:".25vw solid red"})}),Object(P.jsx)(D,{children:Object(P.jsx)("h1",{children:O?"".concat(O):"-/-"})})]}),Object(P.jsxs)(h.a,{variant:G,color:W,startIcon:H,onClick:function(){return K()},children:[I?"Stop":"Start"," tuning"]})]})}):Object(P.jsx)(P.Fragment,{})}R.defaultProps={show:!0,onStart:function(){return null},onClose:function(){return null}};var F=T.a.a(v||(v=Object(k.a)(["\n\tposition: absolute;\n\tbottom: 10px;\n\tright: 10px;\n\tdisplay: flex;\n\tflex-direction: column;\n\talignItems: center;\n\tcolor: gray;\n\ttext-decoration: none;\n\tcursor: pointer;\n"]))),N=T.a.div(O||(O=Object(k.a)(["\n\tdisplay: flex;\n\tposition: relative;\n\tbackground-color: #ededed;\n\theight: 100%;\n\twidth: 100%;\n\tjustify-content: center;\n"]))),I={padding:5,width:"80%",height:"min-content",alignSelf:"center"},L=n(108);var G=function(){return Object(P.jsxs)(N,{children:[Object(P.jsxs)(i.a,{sx:I,elevation:12,children:[Object(P.jsx)(u.a,{variant:"h4",children:"Em Tuner \ud83c\udfb8"}),Object(P.jsx)(u.a,{variant:"h7",color:"text.secondary",children:"Tune your instrument by playing a note near your mic or by selecting your input"}),Object(P.jsx)(R,{})]}),Object(P.jsxs)(F,{href:"https://github.com/alexandre-em/Em-tuner",children:[Object(P.jsx)(L.a,{fontSize:"large"}),Object(P.jsx)(u.a,{variant:"h7",color:"text.secondary",style:{textAlign:"center"},children:"Code"})]})]})};a.a.render(Object(P.jsx)(o.a.StrictMode,{children:Object(P.jsx)(G,{})}),document.getElementById("root"))}},[[90,1,2]]]);